<head>
    <title>Early Retirement Calculator</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous" />
    <!-- Google Font for improved typography -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="importmap">
    {
      "imports": {
        "vue": "https://cdn.jsdelivr.net/npm/vue@3.5.24/dist/vue.esm-browser.js"
      },
      "scopes": {}
    }
  </script>
    <link rel="stylesheet" href="styles.css">
    <script src="scripts.js"></script>
</head>

<body 1onload="document.getElementById('divRetirementYear').scrollIntoView();">
    <button id="btnReset" style="width:100%" class="btn btn-warning"
        onclick="localStorage.clear();window.location.reload()">Data saved
        to your browser ONLY, click here to Reset</button>
    <div id="app" class="container-fluid">
        <h3>Early Retirement Calculator</h3> Click <a href="https://github.com/rzou9388/retire">here</a> for source code
        <hr />
        <div class="row">

            <div id="divtabs" class="col-6">
                <nav>
                    <div class="nav nav-tabs" id="nav-tab" role="tablist">
                        <button class="nav-link active" id="nav-home-tab" data-bs-toggle="tab"
                            data-bs-target="#nav-home" type="button" role="tab" aria-controls="nav-home"
                            aria-selected="true" onclick="resetDivTab()">Age</button>
                        <button class="nav-link" id="nav-income-tab" data-bs-toggle="tab" data-bs-target="#nav-income"
                            onclick="resetDivTab()" type="button" role="tab" aria-controls="nav-income"
                            aria-selected="false">Income</button>
                        <button class="nav-link" id="nav-savings-tab" data-bs-toggle="tab" data-bs-target="#nav-savings"
                            onclick="resetDivTab()" type="button" role="tab" aria-controls="nav-savings"
                            aria-selected="false">
                            Savings</button>
                        <button class="nav-link" id="nav-spending-tab" data-bs-toggle="tab" onclick="resetDivTab()"
                            data-bs-target="#nav-spending" type="button" role="tab" aria-controls="nav-spending"
                            aria-selected="false">Spending</button>
                        <button class="nav-link" id="nav-roth-tab" data-bs-toggle="tab" data-bs-target="#nav-roth"
                            onclick="resetDivTab()" type="button" role="tab" aria-controls="nav-roth"
                            aria-selected="false">Roth
                            Conversion</button>

                        <button class="nav-link" id="nav-taxes-tab" data-bs-toggle="tab" data-bs-target="#nav-taxes"
                            onclick="resetDivTab()" type="button" role="tab" aria-controls="nav-taxes"
                            aria-selected="false">Taxes &
                            Inflation</button>
                        <button class="nav-link" id="nav-yearly-tab" data-bs-toggle="tab" data-bs-target="#nav-yearly"
                            type="button" role="tab" aria-controls="nav-yearly" aria-selected="false"
                            onclick="setDivTabClass('col-12')">Yearly
                            Data</button>
                        <button class="nav-link" id="nav-info-tab" data-bs-toggle="tab" data-bs-target="#nav-info"
                            onclick="resetDivTab()" type="button" role="tab" aria-controls="nav-info"
                            aria-selected="false">Info</button>

                    </div>
                </nav>
                <div class="tab-content" id="nav-tabContent">
                    <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
                        <div class="row">
                            <div class="col-4 ">
                                <label for="txtAge">Current Age:</label>
                                <input id="txtAge" class="form-control" v-model="data.person.age" step="1" type="number"
                                    @change="recalculate" max="100" />
                            </div>
                            <div class="col-4">
                                <label for="data.person.retirement.age">Retirement Age:</label>
                                <input id="data.person.retirement.age" class="form-control"
                                    v-model="data.person.retirement.age" step="1" type="number" @change="recalculate" />
                            </div>
                            <div class="col-4">
                                <label for="txtYears">Retire In Years:</label>
                                <input id="txtYears" class="form-control"
                                    :value="this.data.person.retirement.age - this.data.person.age" type="number"
                                    disabled />
                            </div>
                            <div class="col-4">
                                <label for="noPenaltyWithdraw.age">IRA no-penality withdraw age 59.5:</label>
                                <input id="noPenaltyWithdraw.age" class="form-control"
                                    :value="data.noPenaltyWithdraw.age" type="number" disabled />
                            </div>
                            <div class="col-4">
                                <label for="data.medicare.age">Medicare Age:</label>
                                <input id="data.medicare.age" class="form-control" :value="data.medicare.age"
                                    type="number" disabled />
                            </div>
                            <div class="col-4">Required Minimum Distribution Age<label for="rmd.age">:</label>
                                <input id="rmd.age" class="form-control" v-model="data.rmd.age" type="number"
                                    disabled />
                            </div>
                            <div class="col-4">
                                <label for="person.ss.age">Social Security Benefit Age (62-70):</label>
                                <input id="person.ss.age" class="form-control" v-model="data.person.ss.age"
                                    type="number" @change="recalculate" min="62" max="70" />
                            </div>
                            <div class="col-4">
                                <label for="person.deceased.age">Life Expectancy (Age):</label>
                                <input id="person.deceased.age" class="form-control" v-model="data.person.deceased.age"
                                    type="number" @change="recalculate" max="100" />
                            </div>
                        </div>
                        <div>
                            <h5>Summary</h5>
                            You are <b>{{data.person.age}}</b> years old,
                            you are planning to retire in <b>{{data.person.retirement.age-data.person.age}}</b>
                            years in <b>{{data.person.retirement.year}}</b> at the age of
                            <b>{{data.person.retirement.age}}</b> (beginning of the year).
                            You can start penalty free withdrawing from your traditional 401k/IRA accounts at
                            <b>{{data.noPenaltyWithdraw.age}}</b>(59.5), your medicare will kick in when you are
                            <b>{{data.medicare.age}}</b>, and your social security retirement benefit starts at
                            <b>{{data.person.ss.age}}</b>.
                            When you are
                            <b>{{data.rmd.age}}</b>, you'll be required to withdraw (RMD) from your traditional tax
                            deferred accounts (IRA, 401k).
                            Your life expectancy age is
                            <b>{{data.person.deceased.age}}</b>.
                            Your total number of years in retirement is
                            <b>{{data.person.deceased.age-data.person.retirement.age}}</b>.
                            <br />
                        </div>
                    </div>
                    <div class="tab-pane fade" id="nav-income" role="tabpanel" aria-labelledby="nav-income-tab">
                        <div class="row">

                            <div class="row">
                                <h6>Salary based income and savings (you and spouse)</h6>
                                <div class="col-4">
                                    <label for="data.person.salary">Current Combined Salary:</label>
                                    <div class="input-group">
                                        <input id="data.person.salary" class="form-control"
                                            :value="toDollar(data.person.salary)"
                                            @input="e => { let val = e.target.value.replace(/[^\d.]/g, ''); data.person.salary = Number(val); }"
                                            type="text" min="0" step="1000" @change="calculate" />
                                    </div>
                                </div>
                                <div class="col-4">
                                    <label for="data.meritIncrease">Merit Increase:</label>
                                    <div class="input-group">
                                        <input id="data.meritIncrease" class="form-control" v-model="data.meritIncrease"
                                            type="number" min="0" step="1" @change="calculate" />
                                        <span class="input-group-text">%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="col-4">
                                <label for="contrib.employeePercent">Employee 401k Contribution:</label>
                                <div class="input-group">
                                    <input id="contrib.employeePercent" class="form-control"
                                        v-model="data.contrib.employeePercent" type="number" min="1" step="1"
                                        @change="calculate" />
                                    <span class="input-group-text">%</span>
                                </div>
                            </div>
                            <div class="col-4">
                                <label for="contrib.roth401kPercent">Employee <b>Roth</b> 401k Contribution:</label>
                                <div class="input-group">
                                    <input id="contrib.roth401kPercent" class="form-control"
                                        v-model="data.contrib.roth401kPercent" type="number" min="1" step="1"
                                        @change="calculate" />
                                    <span class="input-group-text">%</span>
                                </div>
                            </div>
                            <div class="col-4">
                                <label for="contrib.employerPercent">Employer 401k Match:</label>
                                <div class="input-group">
                                    <input id="contrib.employerPercent" class="form-control"
                                        v-model="data.contrib.employerPercent" type="number" min="0" step="1"
                                        @change="calculate" />
                                    <span class="input-group-text">%</span>
                                </div>
                            </div>
                            <div class="col-4">
                                <label for="contrib.employerMatchUpTo">Employer 401k Match Up To:</label>
                                <div class="input-group">
                                    <input id="contrib.employerMatchUpTo" class="form-control"
                                        v-model="data.contrib.employerMatchUpTo" type="number" min="0" max="10" step="1"
                                        @change="calculate" />
                                    <span class="input-group-text">%</span>
                                </div>
                            </div>
                        </div>

                        <hr />
                        <div>
                            <h5>Summary
                            </h5>
                            Your current household earned income is <b>{{toDollar(data.person.salary)}}</b>, you
                            expect annual merit increase of <b>{{toPercent(data.meritIncrease)}}</b>.
                            <div v-if="data.contrib.totalPercent > 0">
                                Your current tax deferred retirement accounts
                                have<b>{{toDollar(data.person.pretaxBalance)}}</b>, you are contributing
                                <b>{{toPercent(data.contrib.employeePercent)}}</b> of your
                                salary to 401k, and your employer contributes
                                <b>{{toPercent(data.contrib.employerPercent)}}</b> of
                                your contribution up to <b>{{toPercent(data.contrib.employerMatchUpTo)}}</b>, total
                                contribution is <b>{{toPercent(data.contrib.totalPercent)}}</b> of your
                                salary each year. Your current year 401k contribution calculates to be
                                <b>{{toDollar(data.person.salary*data.contrib.totalPercent/100)}}</b>.
                            </div>
                            <div v-if="data.contrib.rothTotalPercent > 0">
                                Your current Roth retirement accounts
                                have<b>{{toDollar(data.person.roth)}}</b>, you are contributing
                                <b>{{toPercent(data.contrib.roth401kPercent)}}</b> of your
                                salary to Roth 401k, and your employer contributes
                                <b>{{toPercent(data.contrib.employerPercent)}}</b> of
                                your contribution up to <b>{{toPercent(data.contrib.employerMatchUpTo)}}</b>, total
                                contribution is <b>{{toPercent(data.contrib.rothTotalPercent)}}</b> of your
                                salary each year. Your current year Roth 401k contribution calculates to be
                                <b>{{toDollar(data.person.salary*data.contrib.rothTotalPercent/100)}}</b>.
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="nav-savings" role="tabpanel" aria-labelledby="nav-savings-tab">
                        <div class="row">
                            <h6>Current Savings (you and spouse)</h6>
                            <div class="col-4">
                                <label for="txtpretaxBalance" title="Traditional IRA, 401k, etc">Current Pretax
                                    Balance:</label>
                                <div class="input-group">
                                    <input id="txtpretaxBalance" class="form-control"
                                        :value="toDollar(data.person.pretaxBalance)"
                                        @input="e => { let val = e.target.value.replace(/[^\d.]/g, ''); data.person.pretaxBalance = Number(val); }"
                                        type="text" step="100" @change="calculate" />
                                </div>
                            </div>

                            <div class="col-4">
                                <label for="data.person.roth">Current Roth Balance:</label>
                                <div class="input-group">
                                    <input id="data.person.roth" class="form-control"
                                        :value="toDollar(data.person.roth)"
                                        @input="e => { let val = e.target.value.replace(/[^\d.]/g, ''); data.person.roth = Number(val); }"
                                        type="text" min="0" step="1000" @change="calculate" />
                                </div>
                            </div>
                            <div class="col-4">
                                <label for="data.person.investment">Current Post Tax Investment:</label>
                                <div class="input-group">
                                    <input id="data.person.investment" class="form-control"
                                        :value="toDollar(data.person.investment)"
                                        @input="e => { let val = e.target.value.replace(/[^\d.]/g, ''); data.person.investment = Number(val); }"
                                        type="text" min="1" step="1000" @change="calculate" />
                                </div>
                            </div>

                        </div>
                        <hr />

                        <div class="row">
                            <h6>Rate of return</h6>
                            <div class="col-4">
                                <label for="annualReturn.beforeRetirement">Annual Return Before Retirement:</label>
                                <div class="input-group">
                                    <input id="annualReturn.beforeRetirement" class="form-control"
                                        v-model="data.annualReturn.beforeRetirement" type="number" min="1" step="1"
                                        @change="calculate" />
                                    <span class="input-group-text">%</span>
                                </div>
                            </div>
                            <div class="col-4">
                                <label for="annualReturn.afterRetirement">Annual Return After Retirement:</label>
                                <div class="input-group">
                                    <input id="annualReturn.afterRetirement" class="form-control"
                                        v-model="data.annualReturn.afterRetirement" type="number" min="1" step="1"
                                        @change="calculate" />
                                    <span class="input-group-text">%</span>
                                </div>
                            </div>
                        </div>
                        <hr />
                        <div>
                            <h5>Net worth
                                <b>{{toDollar(data.person.roth+data.person.investment+data.person.pretaxBalance)}}</b>.
                            </h5>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="nav-spending" role="tabpanel" aria-labelledby="nav-spending-tab">
                        <div>
                            <div class="row">
                                <div class="col-4">
                                    <label for="data.spending.beforeRetirement">Yearly (Before Retirement)</label>
                                    <div class="input-group">
                                        <input id="data.spending.beforeRetirement" class="form-control"
                                            :value="toDollar(data.spending.beforeRetirement)"
                                            @input="e => { let val = e.target.value.replace(/[^\d.]/g, ''); data.spending.beforeRetirement = Number(val); }"
                                            type="text" step="10000" @change="calculate" />
                                    </div>
                                </div>
                                <div class="col-4">
                                    <label for="data.spending.afterRetirement">Yearly (After Retirement)</label>
                                    <div class="input-group">
                                        <input id="data.spending.afterRetirement" class="form-control"
                                            :value="toDollar(data.spending.afterRetirement)"
                                            @input="e => { let val = e.target.value.replace(/[^\d.]/g, ''); data.spending.afterRetirement = Number(val); }"
                                            type="text" step="10000" @change="calculate" />
                                    </div>
                                </div>
                                <div class="col-4">
                                    <label for="data.spending.insurance">Yearly Retirement Health Insurance (Before
                                        Medicare)</label>
                                    <div class="input-group">
                                        <input id="data.spending.insurance" class="form-control"
                                            :value="toDollar(data.spending.insurance)"
                                            @input="e => { let val = e.target.value.replace(/[^\d.]/g, ''); data.spending.insurance = Number(val); }"
                                            type="text" step="1000" @change="calculate" />
                                    </div>
                                </div>
                                <div>
                                    Your estimated yearly spending <b>before</b> retirement is
                                    <b>{{toDollar(data.spending.beforeRetirement)}}</b>,
                                    monthly spending is <b>{{toDollar(data.spending.beforeRetirement/12)}}</b>,
                                    this should include:
                                    <ul>
                                        <li>Housing</li>
                                        <li>Your expensive kid(s) - tuition, activities, etc</li>
                                    </ul>
                                </div>
                                <div>
                                    Your estimated yearly spending <b>after</b> retirement is
                                    <b>{{toDollar(data.spending.afterRetirement)}}</b>, monthly spending is
                                    <b>{{toDollar(data.spending.afterRetirement/12)}}</b>:
                                    <ul>
                                        <li>Lower housing expenses, and hopefully no more mortgage</li>
                                        <li>Higher medical expenses</li>
                                        <li>More traveling</li>
                                    </ul>
                                </div>
                                <div>
                                    Your estimated starting Medicare year <b>{{data.medicare.year}}</b>
                                </div>
                                <div v-if="data.person.retirement.age < data.medicare.age">
                                    When you retire in <b>{{data.person.retirement.age-data.person.age}}</b> years at
                                    <b>{{data.person.retirement.age}}</b>,
                                    you are not yet qualified for Medicare, your estimated your monthly health insurance
                                    out
                                    of pocket before Medicare kicks in is
                                    <b>{{toDollar(data.spending.insurance/12)}}</b>.
                                </div>

                                <div class="mt-3">
                                    Your spending will be adjusted for <b>{{toPercent(data.inflation)}}</b> inflation
                                    every
                                    year.
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="nav-roth" role="tabpanel">
                        <div class="row">
                            <div class="col-4">
                                <label for="distribution.age">Age to start Roth Conversion
                                </label>
                                <input id="distribution.age" class="form-control" v-model="data.distribution.age"
                                    type="number" min="40" step="1" @change="calculate" />
                            </div>
                            <div class="col-4">
                                <label for="distribution.braket"
                                    title="Projected retirement age tax brackets shown">Conversion based on tax
                                    bracket</label>
                                <select id="distribution.braket" @change="calculate" class="form-select"
                                    v-model="data.distribution.bracket">
                                    <option value="0">0%</option>
                                    <option v-for="b in getTaxBracketsForYear(data.distribution.year).data"
                                        :value="b.percent">{{b.percent}}% -
                                        {{toDollar(b.income)}}</option>
                                </select>
                            </div>
                            <div class="col-4">
                                <label for="distribution.offset" title="">- or + $ amount from the bracket</label>
                                <div class="input-group">
                                    <input id="distribution.offset" class="form-control"
                                        :value="toDollar(data.distribution.offset)"
                                        @input="e => { let val = e.target.value.replace(/[^\d.-]/g, ''); data.distribution.offset = Number(val); }"
                                        type="text" step="1000" @change="calculate" />
                                </div>
                            </div>
                        </div>
                        <div class="mt-3">
                            <h5>Required Minimum Distribution <b>{{data.rmd.year}}</b> (age <b>{{data.rmd.age}}</b>)
                            </h5>
                            <div class="mt-3">
                                When you reach the age of <b>{{data.rmd.age}}</b>, you'll be required to take "Required
                                Minimum Distribution" from your tax deferred traditional 401k/IRA accounts, and
                                distribution is taxed at the ordinary income rate.
                            </div>
                            <div class="mt-3">
                                The 'ordinary income' also means that you'll have taxable income, which affects the
                                tax you pay,
                                your Medicare payment, and Social Security retirement benefit taxes. However,
                                there are some tax benefits of keeping some money in the tax-deferred accounts,
                                you want the amount to be low enough that you won't be forced to take out a lot each
                                year.
                                The RMD money you are forced to take out cannot be directly converted to Roth IRA. The
                                IRS requires that you take the RMD for the year before you can perform a Roth
                                conversion.
                            </div>
                            <div class="mt-3">
                                The strategy is to convert your traditional 401k/IRA to Roth IRA as early as possible
                                (typically after you retire),
                                you'll pay taxes for the years of conversion; once converted, your roth balance,
                                including
                                gains, won't be taxed again, and there's no required minimum distribution, nor will your
                                withdraws from Roth count as taxable income.
                            </div>
                            <div class="mt-3">
                                Your Roth conversion starts at <b>{{data.distribution.age}}</b>, and
                                fills up the <b>{{toPercent(data.distribution.bracket)}}</b>tax bracket;
                                <span v-if="data.yearlyData.find(x => x.pretaxBalance == 0)">at
                                    <b>{{data.yearlyData.find(x => x.pretaxBalance == 0).age-1}}</b>, your tax deferred
                                    accounts will have <b>$0.00</b></span>

                                at <b>{{data.rmd.age}}</b>, your tax
                                deferred accounts will have <b>{{toDollar(data.rmd.pretaxBalance)}}</b>.
                                <div v-if="data.rmd.pretaxBalance>0">
                                    you'll be required to withdraw <b>{{toDollar(data.rmd.pretaxBalance)}}</b> / 27.4 =
                                    <b>{{toDollar(data.rmd.rmd)}}</b> on first year and increases percentage wise every
                                    year
                                    after. Your tax bill on that first year distribution is around
                                    <b>{{toDollar(calculateOrdinaryIncomeTaxForYear(this.data.rmd.rmd,
                                        this.data.rmd.year))}}</b>.
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="nav-taxes" role="tabpanel">
                        <div class="row">
                            <div class="col-4">
                                <label for="data.tax.state.beforeRetirement">State Tax (Before Retirement)</label>
                                <div class="input-group">
                                    <input id="data.tax.state.beforeRetirement" class="form-control"
                                        v-model="data.tax.state.beforeRetirement" type="number" min="0" step="1"
                                        @change="calculate" />
                                    <span class="input-group-text">%</span>
                                </div>
                            </div>
                            <div class="col-4">
                                <label for="data.tax.state.afterRetirement">State Tax (After Retirement)</label>
                                <div class="input-group">
                                    <input id="data.tax.state.afterRetirement" class="form-control"
                                        v-model="data.tax.state.afterRetirement" type="number" min="0" step="1"
                                        @change="calculate" />
                                    <span class="input-group-text">%</span>
                                </div>
                            </div>
                            <div class="col-4">
                                <label for="inflation">Inflation</label>
                                <div class="input-group">
                                    <input id="inflation" class="form-control" v-model="data.inflation" type="number"
                                        step="1" @change="calculate" />
                                    <span class="input-group-text">%</span>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h5>Taxes</h5>
                            <div class="mt-3">
                                <ul>
                                    <li>Federal Ordinary Income Tax (see table below) - with historical 1.7% increase in
                                        bracket
                                        ceilings each year</li>
                                    <li>Federal Capital Gain Tax (0%/15%/20%/23.8% for long term)</li>
                                    <li>FICA (SS & Medicare), 6.2%, and extra 0.9% for portion of salary income over
                                        $250,000;
                                        no FICA on capital gains or roth conversion.</li>
                                    <li>Medicare Surtax 3.8% on Capital Gain for MAGI over $250,000.</li>
                                    <li>State Tax inputs allows different taxes for before and after retirement.</li>
                                    <li>Long-term capital gains can't push you into a higher tax bracket</li>
                                </ul>
                            </div>
                            <div class="mt-3">
                                <h6>Social Security benefits tax: </h6>
                                Depending on your 'provisional income', 0%-85% of SSN income is taxed.
                                'Provisional income' includes gross income (wages, interest, dividend, pension, rent
                                income), tax-free interest (municipal bond) and 1/2 of SS Benefits.
                                <ul>
                                    <li>
                                        For single filer (tax): if provisional income is less than 25000, 0%; between
                                        25000 and 34000, then 50%, above 34000 = 85%.
                                    </li>
                                    <li>
                                        Married Filing Jointly: less than 32,000 = 0%, between 32000 and 44000 = 50%, >
                                        44000, then 85%.
                                    </li>
                                    <li>Note: provisional income is not inflation adjusted.</li>
                                </ul>
                                The resulting percentage of SS Benefits is subject to ordinary income tax rate.
                                <br />
                                Note: The calculation assumes there's no state tax for SS benefits.
                                <br />
                                Note: Roth IRA distributions are not included in the provisional income calculation.
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="nav-yearly" role="tabpanel">
                        <div class="row">
                            <div class="form-check col-1">
                                <input class="form-check-input" id="col-age" type="checkbox" @change="saveState"
                                    v-model="data.columns.age" />
                                <label class="form-check-label" for="col-age">Age</label>
                            </div>
                            <div class="form-check col">
                                <input class="form-check-input" id="col-year" type="checkbox"
                                    v-model="data.columns.year" />
                                <label class="form-check-label" for="col-year">Year</label>
                            </div>
                            <div class="form-check col">
                                <input class="form-check-input" id="col-salary" type="checkbox"
                                    v-model="data.columns.salary" />
                                <label class="form-check-label" for="col-salary">Salary</label>
                            </div>
                            <div class="form-check col">
                                <input class="form-check-input" id="col-contrib" type="checkbox"
                                    v-model="data.columns.contrib" />
                                <label class="form-check-label" for="col-contrib">401K
                                    Contrib {{toPercent(data.contrib.totalPercent)}}</label>
                            </div>
                            <div class="form-check col">
                                <input class="form-check-input" id="col-contribRoth" type="checkbox"
                                    v-model="data.columns.contribRoth" />
                                <label class="form-check-label" for="col-contribRoth">Roth 401K
                                    {{toPercent(data.contrib.rothTotalPercent)}}</label>
                            </div>
                            <div class="form-check col">
                                <input class="form-check-input" id="col-rmd" type="checkbox"
                                    v-model="data.columns.rmd" />
                                <label class="form-check-label" for="col-rmd"
                                    title="Required Minimum Distribution">RMD</label>
                            </div>
                            <div class="form-check col">
                                <input class="form-check-input" id="col-spending" type="checkbox"
                                    v-model="data.columns.spending" />
                                <label class="form-check-label" for="col-spending">Spending</label>
                            </div>
                            <div class="form-check col">
                                <input class="form-check-input" id="col-dist" type="checkbox"
                                    v-model="data.columns.dist" />
                                <label class="form-check-label" for="col-dist">Roth Conversion</label>
                            </div>
                            <div class="form-check col">
                                <input class="form-check-input" id="col-pretax" type="checkbox"
                                    v-model="data.columns.pretax" />
                                <label title="traditional 401k, IRA, etc" class="form-check-label" for="col-pretax">Tax
                                    Deferred Balance</label>
                            </div>
                            <div class="form-check col">
                                <input class="form-check-input" id="col-roth" type="checkbox"
                                    v-model="data.columns.roth" />
                                <label class="form-check-label" for="col-roth">Roth</label>
                            </div>
                            <div class="form-check col">
                                <input class="form-check-input" id="col-investment" type="checkbox"
                                    v-model="data.columns.investment" />
                                <label class="form-check-label" for="col-investment">Investment</label>
                            </div>
                            <div class="form-check col">
                                <input class="form-check-input" id="col-medicare" type="checkbox"
                                    v-model="data.columns.medicare" />
                                <label class="form-check-label" for="col-medicare">MedicareB Prem</label>
                            </div>
                            <div class="form-check col">
                                <input class="form-check-input" id="col-ss" type="checkbox" v-model="data.columns.ss" />
                                <label class="form-check-label" for="col-ss">Social Seurity</label>
                            </div>
                            <div class="form-check col">
                                <input class="form-check-input" id="col-tax" type="checkbox"
                                    v-model="data.columns.tax" />
                                <label class="form-check-label" for="col-tax">Taxes</label>
                            </div>
                            <div class="form-check col">
                                <input class="form-check-input" id="col-net" type="checkbox"
                                    v-model="data.columns.netWorth" />
                                <label class="form-check-label" for="col-net">Net Worth</label>
                            </div>
                        </div>

                        <table class="table table-strip table-hover mt-1">
                            <thead>
                                <th v-if="data.columns.age">Age</th>
                                <th v-if="data.columns.year">Year</th>
                                <th v-if="data.columns.salary">Salary</th>
                                <th v-if="data.columns.contrib">401k Contrib</th>
                                <th v-if="data.columns.contribRoth">Roth 401k Contrib</th>
                                <th title="Required Minimum Distribution" v-if="data.columns.rmd">RMD</th>
                                <th v-if="data.columns.spending" title="inflation adjusted">Spending
                                </th>
                                <th v-if="data.columns.dist">Roth Conversion</th>
                                <th v-if="data.columns.pretax" title="traditional 401k, IRA">Tax
                                    Deferred Balance</th>
                                <th v-if="data.columns.roth">Roth Balance</th>
                                <th v-if="data.columns.investment" title="post-tax brokerage + savings">
                                    Investment
                                </th>
                                <th v-if="data.columns.medicare">Medicare</th>
                                <th v-if="data.columns.ss">Social Security</th>
                                <th title="FICA, Federal, State, Ordinary Income and Capital Gains"
                                    v-if="data.columns.tax">
                                    Taxes</th>
                                <th v-if="data.columns.netWorth">Net Worth</th>
                            </thead>
                            <tbody>
                                <tr v-for="yearly in data.yearlyData" :class="{
                                            retirementAge:yearly.age===data.person.retirement.age,
                                            rmdAge:yearly.age ===data.rmd.age,
                                            medicareAge:yearly.age === data.medicare.age,
                                            ssAge:yearly.age === data.person.ss.age,
                                            noPenaltyAge:yearly.age === data.noPenaltyWithdraw.age
                                        }" :title="yearly.title">
                                    <td v-if="data.columns.age">{{yearly.age}}</td>
                                    <td v-if="data.columns.year">{{yearly.year}}</td>
                                    <td v-if="data.columns.salary">{{toDollar(yearly.salary)}}</td>
                                    <td v-if="data.columns.contrib">{{toDollar(yearly.k401)}}</td>
                                    <td v-if="data.columns.contribRoth">{{toDollar(yearly.roth401k)}}</td>
                                    <td v-if="data.columns.rmd">{{toDollar(yearly.rmd)}}</td>
                                    <td v-if="data.columns.spending" class="spending">
                                        -{{toDollar(yearly.spending)}}</td>
                                    <td v-if="data.columns.dist">{{toDollar(yearly.dist)}}</td>
                                    <td v-if="data.columns.pretax">
                                        <span
                                            :class="{negative:yearly.pretaxBalance <0,positive:yearly.pretaxBalance>0}">
                                            {{toDollar(yearly.pretaxBalance)}}</span>
                                    </td>
                                    <td v-if="data.columns.roth">
                                        <span
                                            :class="{negative:yearly.roth <0,positive:yearly.roth>0}">{{toDollar(yearly.roth)}}</span>
                                    </td>
                                    <td v-if="data.columns.investment">
                                        <span :class="{negative:yearly.investment <0,positive:yearly.investment>0}">
                                            {{toDollar(yearly.investment)}}</span>
                                    </td>
                                    <td v-if="data.columns.medicare"><span
                                            :class="{negative:yearly.medicare>0}">-{{toDollar(yearly.medicare)}}</span></span>
                                    </td>
                                    <td v-if="data.columns.ss"><span
                                            :class="{positive:yearly.ss>0}">{{toDollar(yearly.ss)}}</span>
                                    </td>
                                    <td v-if="data.columns.tax"><span :class="{negative:yearly.tax>0}"
                                            :title="JSON.stringify(getTaxBracketsForYear(yearly.year).data)">-{{toDollar(yearly.tax)}}</span>
                                    </td>
                                    <td v-if="data.columns.netWorth">
                                        <span :class="{negative:yearly.netWorth <0,positive:yearly.netWorth>0}">
                                            {{toDollar(yearly.netWorth)}}</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="tab-pane fade" id="nav-info">
                        <details>
                            <summary>Projected Tax Rates</summary>
                            <div class="row">
                                Calculated with historical 1.7% increase in bracket ceilings each year, and accounted
                                for 2025 trump tax (Tax Cuts and Jobs Act) brackets.
                                <table class="table table-hover table-strip">
                                    <thead>
                                        <tr>
                                            <th>Year</th>
                                            <th>Rate</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr
                                            v-for="y in data.tax.brackets.filter(x => x.year >= (new Date()).getFullYear())">
                                            <td>{{y.year}}</td>
                                            <td>
                                                <table>
                                                    <tr v-for="b in y.data">
                                                        <td>{{toPercent(b.percent)}}</td>
                                                        <td>{{toDollar(b.income)}}</td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </details>

                    </div>
                </div>
            </div>
            <div class="col-6 overflow-auto">
                <div id="chartParent" style="height:450px;display:none"></div>

                <hr />

                <nav>
                    <div class="nav nav-tabs" id="nav-tab2" role="tablist">
                        <button class="nav-link active" id="nav-divCurrentYear-tab" data-bs-toggle="tab"
                            data-bs-target="#divCurrentYear" type="button" role="tab" aria-controls="nav-divCurrentYear"
                            aria-selected="true" onclick="resetDivTab()">Current year</button>
                        <button class="nav-link" id="nav-divRetirementYear-tab" data-bs-toggle="tab"
                            data-bs-target="#divRetirementYear" type="button" role="tab"
                            aria-controls="nav-divRetirementYear" aria-selected="true"
                            onclick="resetDivTab()">Retirement year
                        </button>
                        <button class="nav-link" id="nav-divNoPenaltyWithdrawYear-tab" data-bs-toggle="tab"
                            data-bs-target="#divNoPenaltyWithdrawYear" onclick="resetDivTab()" type="button" role="tab"
                            aria-controls="nav-divNoPenaltyWithdrawYear" aria-selected="false">Penalty free withdraw
                            year </button>
                        <button class="nav-link" id="nav-divRmd-tab" data-bs-toggle="tab" data-bs-target="#divRmd"
                            onclick="resetDivTab()" type="button" role="tab" aria-controls="nav-divRmd"
                            aria-selected="false">
                            Required Minimum Distribution year</button>
                        <button class="nav-link" id="nav-divEnd-tab" data-bs-toggle="tab" onclick="resetDivTab()"
                            data-bs-target="#divEnd" type="button" role="tab" aria-controls="nav-divEnd"
                            aria-selected="false">End of life year</button>

                    </div>
                </nav>
                <div class="tab-content" id="nav-tabContent">
                    <div id="divCurrentYear" class="tab-pane fade show active" role="tabpanel">
                        <h6>Current year <b>{{new Date().getFullYear()}}</b> (age <b>{{data.person.age}}</b>)</h6>
                        <pre>
        net worth:              <b>{{toDollar(data.person.roth+data.person.pretaxBalance+data.person.investment)}}</b>
        investment (posttax):   <b>{{toDollar(data.person.investment)}}</b>
        Roth IRA/401k:          <b>{{toDollar(data.person.roth)}}</b>
        IRA/401k:               <b>{{toDollar(data.person.pretaxBalance)}}</b>
                        </pre>

                    </div>
                    <div class="tab-pane fade " id="divRetirementYear" role="tabpanel"
                        aria-labelledby="nav-divRetirementYear-tab">
                        <div class="row">
                            <div>
                                <h6>Retirement year <b>{{data.person.retirement.year}}</b> (age
                                    <b>{{data.person.retirement.age}}</b>)
                                </h6>
                                <pre>
        net worth:              <b>{{toDollar(data.person.retirement.roth+data.person.retirement.pretaxBalance+data.person.retirement.investment)}}</b>
        investment (posttax):   <b>{{toDollar(data.person.retirement.investment)}}</b>
        Roth IRA/401k:          <b>{{toDollar(data.person.retirement.roth)}}</b>
        IRA/401k:               <b>{{toDollar(data.person.retirement.pretaxBalance)}}</b>
                                </pre>
                                <div v-if="data.person.retirement.investment<0" class="alert alert-danger mt-3">
                                    Your current retirement plan cannot get you to
                                    <b>{{data.person.retirement.age}}</b>, your
                                    post-tax balance will be <b>{{toDollar(data.person.retirement.investment)}}</b>, try
                                    adjusting
                                    your retirement plan!
                                </div>
                                After retirement, all your spending, including taxes that you need to pay will come from
                                your
                                post-tax investment account until you reach the age of
                                <b>{{data.noPenaltyWithdraw.age}}</b>, which
                                means that you'll need to pay capital gain taxes for the amount drawn.
                                <div class="alert">Note: the calculation assumes 50% withdraws from post-tax investment
                                    accounts are
                                    capital gains<br />Note: For ease of calculation, age 60 is used, instead of 59.5
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="divNoPenaltyWithdrawYear" role="tabpanel">
                        <div class="row">
                            <div class="mt-3">
                                <h6>Penalty free withdraw year <b>{{data.noPenaltyWithdraw.year}}</b> (age
                                    <b>{{data.noPenaltyWithdraw.age}}</b>)
                                </h6>
                                <div class="mt-3">
                                    After you've reached the age of <b>{{data.noPenaltyWithdraw.age}}</b> (59.5),
                                    <pre>
                net worth:              <b>{{toDollar(data.noPenaltyWithdraw.roth+data.noPenaltyWithdraw.pretaxBalance+data.noPenaltyWithdraw.investment)}}</b>
                investment (posttax):   <b :class="{'negative':data.noPenaltyWithdraw.investment<0}">{{toDollar(data.noPenaltyWithdraw.investment)}}</b>
                Roth IRA/401k:          <b>{{toDollar(data.noPenaltyWithdraw.roth)}}</b>
                IRA/401k:               <b>{{toDollar(data.noPenaltyWithdraw.pretaxBalance)}}</b>
                                    </pre>
                                    <br />
                                    You can start withdrawing funds from pretax accounts without penalty, however,
                                    you'll pay
                                    ordinary income tax for the withdraws. At this time, instead of selling investments
                                    from
                                    post-tax accounts to cover taxes and spending, the funds should come from your
                                    pretax accounts.
                                    The step-up rule allows you to pass down your brokerage investment balance to your
                                    heir without
                                    incurring capital gain tax.
                                </div>
                                <div v-if="data.noPenaltyWithdraw.investment<0" class="alert alert-danger mt-3">
                                    Your current retirement plan cannot get you through
                                    <b>{{data.noPenaltyWithdraw.age}}</b> where
                                    you can withdraw from pretax accounts without penalty. Your post-tax savings is
                                    <b>{{toDollar(data.noPenaltyWithdraw.investment)}}</b>, You have
                                    <b>{{toDollar(data.noPenaltyWithdraw.pretaxBalance)}}</b> in pretax accounts,
                                    consider adjusting
                                    your plan, or look into "55 rule" or "72t" for early withdraw.
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="divRmd" role="tabpanel">
                        <div class="row">
                            <div class="mt-3" id="divRmd">
                                <h6>Required Minimum Distribution year <b>{{data.rmd.year}}</b> (age
                                    <b>{{data.rmd.age}})</b>
                                </h6>
                                <pre>
        net worth:              <b>{{toDollar(data.rmd.roth+data.rmd.pretaxBalance+data.rmd.investment)}}</b>
        investment (posttax):   <b>{{toDollar(data.rmd.investment)}}</b>
        Roth IRA/401k:          <b>{{toDollar(data.rmd.roth)}}</b>
        IRA/401k:               <b>{{toDollar(data.rmd.pretaxBalance)}}</b>
                                </pre>
                                Your pretax retirement accounts will have <b>{{toDollar(data.rmd.pretaxBalance)}}</b>
                                <div class="alert" v-if="data.rmd.pretaxBalance<500000">Good Job</div>
                                <div class="alert" v-if="data.rmd.pretaxBalance>500000">You'll be required to take out
                                    <b>{{toDollar(data.rmd.rmd)}}</b> from your pretax accounts this year, your
                                    estimated tax bill
                                    will be <b class="negative">{{toDollar(data.rmd.tax)}}</b> for withdraw amount of
                                    <b>{{toDollar(data.rmd.dist)}}</b>.
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="divEnd" role="tabpanel">
                        <div class="row">
                            <div class="mt-3">
                                <h6>End of life year <b>{{data.person.deceased.year}}</b> (age
                                    <b>{{data.person.deceased.age}}</b>)
                                </h6>
                                <pre>
                net worth:              <b :class="{'negative':data.person.deceased.roth+data.person.deceased.pretaxBalance+data.person.deceased.investment<0}">{{toDollar(data.person.deceased.roth+data.person.deceased.pretaxBalance+data.person.deceased.investment)}}</b>
                investment (posttax):   <b :class="{'negative':data.person.deceased.investment<0}">{{toDollar(data.person.deceased.investment)}}</b>
                Roth IRA/401k:          <b :class="{'negative':data.person.deceased.roth<0}">{{toDollar(data.person.deceased.roth)}}</b>
                IRA/401k:               <b :class="{'negative':data.person.deceased.pretaxBalance<0}">{{toDollar(data.person.deceased.pretaxBalance)}}</b>
                                </pre>

                            </div>
                            <hr />
                            <div class="alert alert-info">Tip: How much money you will end up with is what matters, not
                                how much
                                taxes you will pay.</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script type="module" src="app-module.js"></script>
<details>
    <summary>TODOs</summary>
    <ol>
        <li>ss income input missing</li>
        <li>add calculation for Singler filer, and other types</li>
        <li>before retirement, if started conversion, and salary doesn't cover tax, need to take tax out of investment
        </li>
        <li>different state capital gain tax from ordinary</li>
        <li>spouse</li>
        <li>today's currency view</li>
        <li>one-off expenses & income</li>
    </ol>
</details>